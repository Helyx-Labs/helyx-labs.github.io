<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>StoryCrafter | #MadeWithHelyx</title>
  <style>
    body {
      font-family: "Poppins", sans-serif;
      background: radial-gradient(circle at top left, #0d111a, #05070c);
      color: #fdfaf6;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      overflow: hidden;
    }

    .container {
      width: 92vw;
      height: 94vh;
      background: rgba(20, 20, 30, 0.85);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 16px;
      backdrop-filter: blur(8px);
      box-shadow: 0 0 25px rgba(255, 140, 40, 0.1);
      display: flex;
      flex-direction: column;
      padding: 20px;
      overflow: hidden;
    }

    header {
      text-align: center;
      margin-bottom: 8px;
    }

    header h1 {
      color: #ff9e45;
      letter-spacing: 1px;
      font-weight: 600;
    }

    header p {
      color: #fac898;
      margin: 5px 0 15px;
    }

    /* Inputs */
    .input-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 10px;
      margin-bottom: 15px;
    }

    .input-grid input {
      background: #1a1a25;
      border: 1px solid rgba(255, 255, 255, 0.4);
      border-radius: 8px;
      padding: 10px;
      color: #fff;
      font-size: 15px;
      outline: none;
      transition: 0.2s;
    }

    .input-grid input:focus {
      border-color: #ff9e45;
      background: #222230;
    }

    /* Story box */
    textarea {
      width: 100%;
      flex: 1;
      background: #1a1a25;
      color: #fff;
      border: 1px solid rgba(255, 255, 255, 0.4);
      border-radius: 10px;
      padding: 12px;
      resize: none;
      font-size: 15px;
      margin-bottom: 15px;
      outline: none;
      transition: 0.2s;
      width: calc(100% - 24px);
    }

    textarea:focus {
      border-color: #ff9e45;
      background: #222230;
    }

    /* Evaluate Button */
    .evaluate-btn, #aboutBtn {
      align-self: center;
      background: linear-gradient(90deg, #ff9e45, #ffb366);
      color: #101010;
      font-weight: 600;
      padding: 10px 26px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-size: 16px;
      transition: 0.3s;
      margin-bottom: 10px;
    }

    .evaluate-btn:hover, #aboutBtn:hover {
      transform: scale(1.05);
      box-shadow: 0 0 12px rgba(255, 158, 69, 0.5);
    }

    /* Evaluation area */
    .result {
      background: rgba(255, 255, 255, 0.05);
      padding: 10px 15px;
      border-radius: 8px;
      text-align: center;
      color: #ffb366;
      font-weight: 500;
      font-size: 1rem;
      display: none;
    }

    footer {
      text-align: center;
      font-size: 0.85rem;
      margin-top: 8px;
      color: #888;
    }

    footer span {
      color: #ff9e45;
      font-weight: 500;
    }

      /* Modal styles */
  .modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.75);
  }

  .modal-content {
    background: #1e1e2f;
    margin: 10% auto;
    padding: 20px;
    border-radius: 16px;
    width: 90%;
    max-width: 600px;
    color: #FAC898;
    line-height: 1.6;
    position: relative;
    box-shadow: 0 0 25px rgba(242,140,40,0.3);
  }

  .modal h2 {
    color: #F28C28;
    text-align: center;
    margin-top: 0;
  }

  .close {
    color: #aaa;
    position: absolute;
    top: 12px;
    right: 16px;
    font-size: 1.5em;
    cursor: pointer;
  }

  .close:hover {
    color: #FFF5EE;
  }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>StoryCrafter</h1>
      <p>Evaluated by <span style="color:#ff9e45;">Helyx Cogni</span></p>
    </header>

    <div class="input-grid">
      <input type="text" id="character" placeholder="Character">
      <input type="text" id="setting" placeholder="Setting">
      <input type="text" id="action" placeholder="Action">
      <input type="text" id="genre" placeholder="Genre">
    </div>

    <textarea id="story" placeholder="Write your story here..."></textarea>

    <button class="evaluate-btn" id="evaluateBtn">Evaluate Story</button>

    <button id="aboutBtn">About this Project</button>

    <div class="result" id="resultBox"></div>



    <footer>
      #MadeWith<span>Helyx</span> | Powered by Helyx Labs
    </footer>

    <div id="aboutModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>About This Project</h2>
      <p>
        This isn’t just an evaluator; it’s a story of effort, imagination, and guidance.  
        Helyx Labs exists to help ideas come to life, and this small project is one proof of that vision.
      </p>
      <p>
        Behind every line of code is dedication, curiosity, and the intent to empower creators.  
        This tool encourages creativity, supports learning, and celebrates the journey of building something meaningful.
      </p>
      <p>
        <strong>#MadeWithHelyx</strong> — where ideas meet action, and imagination becomes reality.
      </p>
    </div>
  </div>
  </div>

<script type="module">
  import { GoogleGenAI } from 'https://esm.run/@google/genai@latest';

  const GEMINI_API_KEY = "AIzaSyDn8pkTobADYEFYq0lbYrwo00LF_hayU8M";
  const ai = new GoogleGenAI({ apiKey: GEMINI_API_KEY });

  const evaluateBtn = document.getElementById('evaluateBtn');
  const aboutBtn = document.getElementById('aboutBtn');

  // Modals
  const aboutModal = document.getElementById("aboutModal");

  const resultModal = document.createElement("div");
  resultModal.className = "modal";
  resultModal.innerHTML = `
    <div class="modal-content" id="resultContent">
      <span class="close" id="closeResultModal">&times;</span>
      <h2>Evaluation Result</h2>
      <div id="modalResultBox" style="color:#FAC898; line-height:1.5;"></div>
    </div>
  `;
  document.body.appendChild(resultModal);

  // Show About Modal
  aboutBtn.onclick = () => aboutModal.style.display = "block";

  // Close About Modal
  document.getElementsByClassName("close")[0].onclick = () => aboutModal.style.display = "none";

  // Close on outside click
  window.onclick = (e) => {
    if (e.target == aboutModal) aboutModal.style.display = "none";
    if (e.target == resultModal) resultModal.style.display = "none";
  };

  evaluateBtn.addEventListener('click', async () => {
    const char = document.getElementById('character').value.trim();
    const set = document.getElementById('setting').value.trim();
    const act = document.getElementById('action').value.trim();
    const genre = document.getElementById('genre').value.trim();
    const story = document.getElementById('story').value.trim();

    if (!char || !set || !act || !genre || !story) {
      alert("Please fill in all inputs before evaluating!");
      return;
    }

    const prompt = `
You are an impartial story evaluator for StoryCrafter.
Evaluate the following story using the provided values:
- Character: ${char}
- Setting: ${set}
- Action: ${act}
- Genre: ${genre}

STORY:
"""${story.replace(/"/g, '\\"')}"""

Rate this story from 0-10 on these metrics:
1. Creativity
2. Clarity
3. Depth
4. Use of the given words / Accuracy
5. Bonus (style/emotion/twist)

Return ONLY valid JSON with no code blocks, no backticks, no explanations. Strictly this format:
{
  "creativity": <number>,
  "clarity": <number>,
  "depth": <number>,
  "accuracy": <number>,
  "bonus": <number>,
  "feedback": "<one short helpful sentence>"
}
    `;

    const resultBox = document.getElementById('modalResultBox');

    try {
      const response = await ai.models.generateContent({
        model: "gemini-2.5-flash-lite",
        contents: prompt
      });

      let output = typeof response.text === "function" ? await response.text() : response.text;
      output = output.replace(/```json|```/g, "").trim(); // strip any code fencing

      let result = JSON.parse(output);

      resultBox.innerHTML = `
        <p><strong>Creativity:</strong> ${result.creativity}/10</p>
        <p><strong>Clarity:</strong> ${result.clarity}/10</p>
        <p><strong>Depth:</strong> ${result.depth}/10</p>
        <p><strong>Accuracy:</strong> ${result.accuracy}/10</p>
        <p><strong>Bonus:</strong> ${result.bonus}/10</p>
        <p><em>✨ ${result.feedback}</em></p>
      `;

      // Show Result Modal
      resultModal.style.display = "block";

    } catch (err) {
      console.error(err);
      resultBox.innerHTML = `<span style="color: red;">Error: ${err.message}</span>`;
      resultModal.style.display = "block";
    }
  });

  // Close Result Modal
  document.getElementById("closeResultModal").onclick = () => resultModal.style.display = "none";
</script>


</body>
</html>
